# ç”µå­å•†åŠ¡æ¨èç³»ç»Ÿ

åŸºäº Hadoop + Spark çš„ç”µå­å•†åŠ¡æ¨èç³»ç»Ÿï¼Œä½¿ç”¨ Retailrocket æ•°æ®é›†å®ç°å•†å“æ¨èåŠŸèƒ½ã€‚

## ğŸ“ é¡¹ç›®ç»“æ„

```
ecommerce-recommender/
â”œâ”€â”€ data/                           # åŸå§‹æ•°æ®ç›®å½•
â”‚   â”œâ”€â”€ events.csv                  # ç”¨æˆ·è¡Œä¸ºæ•°æ®
â”‚   â”œâ”€â”€ item_properties_part1.csv   # å•†å“å±æ€§æ•°æ®
â”‚   â”œâ”€â”€ item_properties_part2.csv
â”‚   â””â”€â”€ category_tree.csv           # ç±»ç›®æ ‘æ•°æ®
â”œâ”€â”€ scripts/                        # Shellè„šæœ¬
â”‚   â”œâ”€â”€ 00_check_environment.sh     # ç¯å¢ƒæ£€æŸ¥
â”‚   â””â”€â”€ 01_upload_to_hdfs.sh        # ä¸Šä¼ æ•°æ®åˆ°HDFS
â”œâ”€â”€ sql/                            # Hive SQLè„šæœ¬
â”‚   â”œâ”€â”€ 01_create_tables.sql        # å»ºè¡¨è¯­å¥
â”‚   â””â”€â”€ 02_data_analysis.sql        # æ•°æ®åˆ†æ
â”œâ”€â”€ spark/                          # Sparkç¨‹åº
â”‚   â”œâ”€â”€ 02_data_preprocessing.py    # æ•°æ®é¢„å¤„ç†
â”‚   â”œâ”€â”€ 03_train_als_model.py       # ALSæ¨¡å‹è®­ç»ƒ
â”‚   â””â”€â”€ 04_visualization.py         # æ•°æ®å¯è§†åŒ–
â”œâ”€â”€ output/                         # è¾“å‡ºç»“æœ
â”‚   â””â”€â”€ figures/                    # å¯è§†åŒ–å›¾è¡¨
â””â”€â”€ README.md
```

## ğŸ”§ ç¯å¢ƒè¦æ±‚

- **æ“ä½œç³»ç»Ÿ**: Ubuntu 18.04+
- **Hadoop**: 3.x
- **Spark**: 3.x
- **Hive**: 3.x
- **Python**: 3.8+
- **Java**: 8 æˆ– 11

### Pythonä¾èµ–
```bash
pip install pyspark pandas matplotlib numpy
```

## ğŸ“Š æ•°æ®é›†

ä½¿ç”¨ Kaggle ä¸Šçš„ Retailrocket ç”µå­å•†åŠ¡æ•°æ®é›†ï¼š
- ä¸‹è½½åœ°å€: https://tianchi.aliyun.com/dataset/146321

æ•°æ®è¯´æ˜ï¼š
- `events.csv`: 270ä¸‡æ¡ç”¨æˆ·è¡Œä¸ºè®°å½•ï¼ˆæµè§ˆ/åŠ è´­/è´­ä¹°ï¼‰
- `item_properties.csv`: å•†å“å±æ€§ä¿¡æ¯
- `category_tree.csv`: å•†å“ç±»ç›®å±‚çº§

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¬¬ä¸€æ­¥ï¼šæ£€æŸ¥ç¯å¢ƒ
```bash
# åœ¨ä¸»èŠ‚ç‚¹æ‰§è¡Œ
chmod +x scripts/*.sh
./scripts/00_check_environment.sh
```

### ç¬¬äºŒæ­¥ï¼šä¸‹è½½å¹¶ä¸Šä¼ æ•°æ®
```bash
# 1. å°†æ•°æ®æ–‡ä»¶æ”¾åˆ° data/ ç›®å½•
# 2. ä¸Šä¼ åˆ°HDFS
./scripts/01_upload_to_hdfs.sh
```

### ç¬¬ä¸‰æ­¥ï¼šåˆ›å»ºHiveè¡¨
```bash
hive -f sql/01_create_tables.sql
```

### ç¬¬å››æ­¥ï¼šè¿è¡Œæ•°æ®åˆ†æ
```bash
# Hiveåˆ†æ
hive -f sql/02_data_analysis.sql

# Sparké¢„å¤„ç†
spark-submit --master yarn spark/02_data_preprocessing.py
```

### ç¬¬äº”æ­¥ï¼šè®­ç»ƒæ¨èæ¨¡å‹
```bash
spark-submit --master yarn \
    --driver-memory 4g \
    --executor-memory 4g \
    --num-executors 3 \
    spark/03_train_als_model.py
```

### ç¬¬å…­æ­¥ï¼šç”Ÿæˆå¯è§†åŒ–
```bash
python spark/04_visualization.py
```

## ğŸ“ˆ æŠ€æœ¯æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       æŠ€æœ¯æ¶æ„å›¾                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚   æ•°æ®æº          å­˜å‚¨å±‚           è®¡ç®—å±‚          åº”ç”¨å±‚     â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ CSV  â”‚ â”€â”€â†’  â”‚ HDFS â”‚  â”€â”€â†’  â”‚  Spark   â”‚ â”€â†’ â”‚ æ¨èç»“æœ â”‚  â”‚
â”‚  â”‚ æ–‡ä»¶ â”‚      â”‚      â”‚       â”‚  MLlib   â”‚    â”‚          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                    â”‚               â†‘                         â”‚
â”‚                    â†“               â”‚                         â”‚
â”‚               â”Œâ”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚               â”‚ Hive â”‚  â†â”€â”€  â”‚ SparkSQL â”‚                    â”‚
â”‚               â”‚æ•°æ®ä»“åº“â”‚       â”‚          â”‚                    â”‚
â”‚               â””â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ§® æ ¸å¿ƒç®—æ³•

### ALS (äº¤æ›¿æœ€å°äºŒä¹˜æ³•) æ¨èç®—æ³•

```
ç”¨æˆ·-å•†å“è¯„åˆ†çŸ©é˜µ R â‰ˆ U Ã— V^T

å…¶ä¸­:
- R: mÃ—n è¯„åˆ†çŸ©é˜µ
- U: mÃ—k ç”¨æˆ·éšå› å­çŸ©é˜µ
- V: nÃ—k å•†å“éšå› å­çŸ©é˜µ
- k: éšå› å­ç»´åº¦
```

### éšå¼è¯„åˆ†è®¡ç®—
| è¡Œä¸ºç±»å‹ | åˆ†æ•°æƒé‡ |
|----------|----------|
| view     | 1        |
| addtocart| 2        |
| transaction| 3      |

## ğŸ“‹ Hiveè¡¨ç»“æ„

| è¡¨å | è¯´æ˜ | å­˜å‚¨æ ¼å¼ |
|------|------|----------|
| user_events | ç”¨æˆ·è¡Œä¸ºäº‹ä»¶ | TextFile |
| item_properties | å•†å“å±æ€§ | TextFile |
| category_tree | ç±»ç›®æ ‘ | TextFile |
| user_item_ratings | ç”¨æˆ·å•†å“è¯„åˆ† | Parquet |
| user_recommendations | æ¨èç»“æœ | Parquet |
| daily_statistics | æ¯æ—¥ç»Ÿè®¡ | Parquet |

## ğŸ¯ é¢„æœŸè¾“å‡º

1. **æ•°æ®åˆ†ææŠ¥å‘Š**
   - ç”¨æˆ·è¡Œä¸ºåˆ†å¸ƒ
   - è½¬åŒ–æ¼æ–—åˆ†æ
   - çƒ­é—¨å•†å“æ’è¡Œ

2. **æ¨èæ¨¡å‹**
   - RMSE < 2.0
   - MAE < 1.5

3. **å¯è§†åŒ–å›¾è¡¨**
   - äº‹ä»¶åˆ†å¸ƒå›¾
   - è½¬åŒ–æ¼æ–—å›¾
   - æ´»è·ƒåº¦è¶‹åŠ¿å›¾
   - æ¨¡å‹æ€§èƒ½å›¾

## ğŸ” å¸¸è§é—®é¢˜

### Q1: HDFSè¿æ¥å¤±è´¥
```bash
# æ£€æŸ¥HDFSçŠ¶æ€
hdfs dfsadmin -report
# å¦‚æœæœªå¯åŠ¨
start-dfs.sh
```

### Q2: Hiveå…ƒæ•°æ®é”™è¯¯
```bash
# åˆå§‹åŒ–Hiveå…ƒæ•°æ®
schematool -dbType derby -initSchema
```

### Q3: Sparkå†…å­˜ä¸è¶³
```bash
# å¢åŠ å†…å­˜é…ç½®
spark-submit --driver-memory 8g --executor-memory 8g ...
```

## ğŸ“š å‚è€ƒèµ„æ–™

- [Spark MLlibå®˜æ–¹æ–‡æ¡£](https://spark.apache.org/docs/latest/ml-guide.html)
- [ALSæ¨èç®—æ³•åŸç†](https://spark.apache.org/docs/latest/ml-collaborative-filtering.html)
- [Hiveç”¨æˆ·æ‰‹å†Œ](https://cwiki.apache.org/confluence/display/Hive)

## ğŸ‘¥ ä½œè€…

å¤§æ•°æ®è¯¾ç¨‹è®¾è®¡é¡¹ç›®

---

**æœ€åæ›´æ–°**: 2026å¹´1æœˆ
